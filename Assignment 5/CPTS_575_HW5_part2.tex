% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  12pt,
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\KOMAoption{captions}{tableheading}
\usepackage{titling}
\pretitle{\begin{center}\Huge\bfseries}
\posttitle{\par\end{center}\vfill}
\preauthor{\begin{center}\Large}
\postauthor{\par\end{center}\vfill}
\predate{\begin{center}\Large}
\postdate{\par\end{center}\vfill}
\usepackage{fancyhdr}
\fancypagestyle{plain}{ \fancyhf{} \renewcommand{\headrulewidth}{0pt} \renewcommand{\footrulewidth}{0pt} \fancyfoot[C]{\thepage} }
\pagestyle{empty}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother

\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Assignment 5.b},
  pdfauthor={Athul Jose P \textbackslash{} 11867566},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{Assignment 5.b}
\usepackage{etoolbox}
\makeatletter
\providecommand{\subtitle}[1]{% add subtitle to \maketitle
  \apptocmd{\@title}{\par {\large #1 \par}}{}{}
}
\makeatother
\subtitle{CptS 575 Data Science}
\author{}
\date{}

\begin{document}
\maketitle


\begin{center}
{\Large Athul Jose P \\ 11867566} \\[0.5cm]
{\large School of Electrical Engineering and Computer Science} \\[0.5cm]
{\large Washington State University} \\[0.5cm]
{\large CptS 575 Data Science} \\[0.5cm]
\end{center}

\newpage

\subsubsection{\texorpdfstring{\textbf{1.}}{1.}}\label{section}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# loading libraries}
\FunctionTok{library}\NormalTok{(readr)}
\FunctionTok{library}\NormalTok{(tm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Loading required package: NLP
\end{verbatim}

\begin{verbatim}

Attaching package: 'NLP'
\end{verbatim}

\begin{verbatim}
The following object is masked from 'package:ggplot2':

    annotate
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(SnowballC)}
\FunctionTok{library}\NormalTok{(quanteda)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Package version: 4.1.0
Unicode version: 15.1
ICU version: 74.1
\end{verbatim}

\begin{verbatim}
Parallel computing: 8 of 8 threads used.
\end{verbatim}

\begin{verbatim}
See https://quanteda.io for tutorials and examples.
\end{verbatim}

\begin{verbatim}

Attaching package: 'quanteda'
\end{verbatim}

\begin{verbatim}
The following object is masked from 'package:tm':

    stopwords
\end{verbatim}

\begin{verbatim}
The following objects are masked from 'package:NLP':

    meta, meta<-
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# loading dataset}
\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"bbc.csv"}\NormalTok{, }\AttributeTok{show\_col\_types =} \ConstantTok{FALSE}\NormalTok{)}

\CommentTok{\# preprocessing and creating dtm}
\NormalTok{corpus }\OtherTok{\textless{}{-}} \FunctionTok{corpus}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{text)}
\NormalTok{corpus }\OtherTok{\textless{}{-}} \FunctionTok{tokens}\NormalTok{(corpus, }
                \AttributeTok{what =} \StringTok{"word"}\NormalTok{, }
                \AttributeTok{remove\_punct =} \ConstantTok{TRUE}\NormalTok{, }
                \AttributeTok{remove\_numbers =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
                \FunctionTok{tokens\_tolower}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
                \FunctionTok{tokens\_remove}\NormalTok{(}\FunctionTok{stopwords}\NormalTok{(}\StringTok{"english"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
                \FunctionTok{tokens\_wordstem}\NormalTok{(}\AttributeTok{language =} \StringTok{"en"}\NormalTok{)}

\NormalTok{dtm }\OtherTok{\textless{}{-}} \FunctionTok{dfm}\NormalTok{(corpus)}

\CommentTok{\# top 85\% frequency}
\NormalTok{term\_freq }\OtherTok{\textless{}{-}} \FunctionTok{colSums}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(dtm))}
\NormalTok{term\_freq }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(term\_freq, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{threshold }\OtherTok{\textless{}{-}} \FunctionTok{quantile}\NormalTok{(term\_freq, }\FloatTok{0.15}\NormalTok{)}
\NormalTok{dtm\_thres }\OtherTok{\textless{}{-}}\NormalTok{ dtm[, term\_freq }\SpecialCharTok{\textgreater{}=}\NormalTok{ threshold]}

\CommentTok{\# 2205th article}
\NormalTok{article\_vector }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(dtm\_thres[}\DecValTok{2205}\NormalTok{, ])}
\NormalTok{article\_vector\_filtered }\OtherTok{\textless{}{-}}\NormalTok{ article\_vector[article\_vector }\SpecialCharTok{\textgreater{}=} \DecValTok{4}\NormalTok{]}
\FunctionTok{print}\NormalTok{(article\_vector\_filtered)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] 6 4 6 4 4 4 4 4 4 8 4 5 5 4 5 4 5
\end{verbatim}

\newpage

\subsubsection{\texorpdfstring{\textbf{2.}}{2.}}\label{section-1}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# loading libraries}
\FunctionTok{library}\NormalTok{(quanteda)}
\FunctionTok{library}\NormalTok{(caret)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Loading required package: lattice
\end{verbatim}

\begin{verbatim}

Attaching package: 'caret'
\end{verbatim}

\begin{verbatim}
The following object is masked from 'package:purrr':

    lift
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(naivebayes)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
naivebayes 1.0.0 loaded
\end{verbatim}

\begin{verbatim}
For more information please visit: 
\end{verbatim}

\begin{verbatim}
https://majkamichal.github.io/naivebayes/
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dplyr)}
\FunctionTok{library}\NormalTok{(glmnet)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Loading required package: Matrix
\end{verbatim}

\begin{verbatim}

Attaching package: 'Matrix'
\end{verbatim}

\begin{verbatim}
The following objects are masked from 'package:tidyr':

    expand, pack, unpack
\end{verbatim}

\begin{verbatim}
Loaded glmnet 4.1-8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dtm\_df }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(dtm\_thres))}

\CommentTok{\# dtm reduction using variance}
\NormalTok{feature\_variances }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(dtm\_df, }\DecValTok{2}\NormalTok{, var)}
\NormalTok{variance\_threshold }\OtherTok{\textless{}{-}} \FloatTok{0.1}
\NormalTok{dtm\_reduced }\OtherTok{\textless{}{-}}\NormalTok{ dtm\_df[, feature\_variances }\SpecialCharTok{\textgreater{}}\NormalTok{ variance\_threshold]}

\CommentTok{\# print dimensions}
\FunctionTok{print}\NormalTok{(}\FunctionTok{dim}\NormalTok{(dtm\_df))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  2225 23126
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{dim}\NormalTok{(dtm\_reduced))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2225 1107
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# splitting into train and test}
\NormalTok{data\_split }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(}\AttributeTok{category =}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{category, dtm\_reduced)}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\NormalTok{train\_index }\OtherTok{\textless{}{-}} \FunctionTok{createDataPartition}\NormalTok{(data\_split}\SpecialCharTok{$}\NormalTok{category, }\AttributeTok{p =} \FloatTok{0.8}\NormalTok{, }\AttributeTok{list =} \ConstantTok{FALSE}\NormalTok{)}
\NormalTok{train\_data }\OtherTok{\textless{}{-}}\NormalTok{ data\_split[train\_index, ]}
\NormalTok{test\_data }\OtherTok{\textless{}{-}}\NormalTok{ data\_split[}\SpecialCharTok{{-}}\NormalTok{train\_index, ]}

\CommentTok{\# Separate x \& y}
\NormalTok{train\_x }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(train\_data[, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{])}
\NormalTok{train\_y }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(train\_data}\SpecialCharTok{$}\NormalTok{category)}
\NormalTok{test\_x }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(test\_data[, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# multinomial naive bayes}
\NormalTok{nb\_model }\OtherTok{\textless{}{-}} \FunctionTok{multinomial\_naive\_bayes}\NormalTok{(train\_x, train\_y)}
\NormalTok{nb\_predictions }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(nb\_model, }\AttributeTok{newdata =}\NormalTok{ test\_x)}
\NormalTok{nb\_predictions }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(nb\_predictions, }\AttributeTok{levels =} \FunctionTok{levels}\NormalTok{(train\_y))}
\NormalTok{test\_data}\SpecialCharTok{$}\NormalTok{category }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(test\_data}\SpecialCharTok{$}\NormalTok{category, }\AttributeTok{levels =} \FunctionTok{levels}\NormalTok{(train\_y))}

\CommentTok{\# confusion matrix}
\NormalTok{conf\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{confusionMatrix}\NormalTok{(nb\_predictions, test\_data}\SpecialCharTok{$}\NormalTok{category)}
\FunctionTok{print}\NormalTok{(conf\_matrix)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Confusion Matrix and Statistics

               Reference
Prediction      business entertainment politics sport tech
  business            95             2        1     0    2
  entertainment        3            70        0     0    1
  politics             2             3       82     0    1
  sport                0             0        0   102    0
  tech                 2             2        0     0   76

Overall Statistics
                                        
               Accuracy : 0.9572        
                 95% CI : (0.934, 0.974)
    No Information Rate : 0.2297        
    P-Value [Acc > NIR] : < 2.2e-16     
                                        
                  Kappa : 0.9463        
                                        
 Mcnemar's Test P-Value : NA            

Statistics by Class:

                     Class: business Class: entertainment Class: politics
Sensitivity                   0.9314               0.9091          0.9880
Specificity                   0.9854               0.9891          0.9834
Pos Pred Value                0.9500               0.9459          0.9318
Neg Pred Value                0.9797               0.9811          0.9972
Prevalence                    0.2297               0.1734          0.1869
Detection Rate                0.2140               0.1577          0.1847
Detection Prevalence          0.2252               0.1667          0.1982
Balanced Accuracy             0.9584               0.9491          0.9857
                     Class: sport Class: tech
Sensitivity                1.0000      0.9500
Specificity                1.0000      0.9890
Pos Pred Value             1.0000      0.9500
Neg Pred Value             1.0000      0.9890
Prevalence                 0.2297      0.1802
Detection Rate             0.2297      0.1712
Detection Prevalence       0.2297      0.1802
Balanced Accuracy          1.0000      0.9695
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Precision and Recall}
\NormalTok{conf\_table }\OtherTok{\textless{}{-}}\NormalTok{ conf\_matrix}\SpecialCharTok{$}\NormalTok{table}
\NormalTok{precision }\OtherTok{\textless{}{-}} \FunctionTok{diag}\NormalTok{(conf\_table) }\SpecialCharTok{/} \FunctionTok{rowSums}\NormalTok{(conf\_table)}
\NormalTok{recall }\OtherTok{\textless{}{-}} \FunctionTok{diag}\NormalTok{(conf\_table) }\SpecialCharTok{/} \FunctionTok{colSums}\NormalTok{(conf\_table)}
\FunctionTok{print}\NormalTok{(}\StringTok{"Precision by class:"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Precision by class:"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(precision)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     business entertainment      politics         sport          tech 
    0.9500000     0.9459459     0.9318182     1.0000000     0.9500000 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\StringTok{"Recall by class:"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Recall by class:"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(recall)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     business entertainment      politics         sport          tech 
    0.9313725     0.9090909     0.9879518     1.0000000     0.9500000 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# multinomial logistic regression}
\NormalTok{train\_y\_numeric }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{as.factor}\NormalTok{(train\_y)) }\SpecialCharTok{{-}} \DecValTok{1}
\NormalTok{log\_reg\_model }\OtherTok{\textless{}{-}} \FunctionTok{cv.glmnet}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(train\_x), train\_y\_numeric, }\AttributeTok{family =} \StringTok{"multinomial"}\NormalTok{, }\AttributeTok{alpha =} \DecValTok{0}\NormalTok{)}
\NormalTok{log\_reg\_predictions }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(log\_reg\_model, }\AttributeTok{newx =} \FunctionTok{as.matrix}\NormalTok{(test\_x), }\AttributeTok{s =} \StringTok{"lambda.min"}\NormalTok{, }\AttributeTok{type =} \StringTok{"class"}\NormalTok{)}
\NormalTok{log\_reg\_predictions }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(log\_reg\_predictions, }\AttributeTok{labels =} \FunctionTok{levels}\NormalTok{(train\_y))}
\NormalTok{test\_y }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(test\_data}\SpecialCharTok{$}\NormalTok{category, }\AttributeTok{levels =} \FunctionTok{levels}\NormalTok{(train\_y))}

\CommentTok{\# confusion matrix}
\NormalTok{conf\_matrix\_log\_reg }\OtherTok{\textless{}{-}} \FunctionTok{confusionMatrix}\NormalTok{(log\_reg\_predictions, test\_y)}
\FunctionTok{print}\NormalTok{(conf\_matrix\_log\_reg)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Confusion Matrix and Statistics

               Reference
Prediction      business entertainment politics sport tech
  business            97             2        1     0    2
  entertainment        2            74        1     0    1
  politics             2             1       78     0    0
  sport                1             0        2   102    0
  tech                 0             0        1     0   77

Overall Statistics
                                          
               Accuracy : 0.964           
                 95% CI : (0.9421, 0.9793)
    No Information Rate : 0.2297          
    P-Value [Acc > NIR] : < 2.2e-16       
                                          
                  Kappa : 0.9548          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: business Class: entertainment Class: politics
Sensitivity                   0.9510               0.9610          0.9398
Specificity                   0.9854               0.9891          0.9917
Pos Pred Value                0.9510               0.9487          0.9630
Neg Pred Value                0.9854               0.9918          0.9862
Prevalence                    0.2297               0.1734          0.1869
Detection Rate                0.2185               0.1667          0.1757
Detection Prevalence          0.2297               0.1757          0.1824
Balanced Accuracy             0.9682               0.9751          0.9657
                     Class: sport Class: tech
Sensitivity                1.0000      0.9625
Specificity                0.9912      0.9973
Pos Pred Value             0.9714      0.9872
Neg Pred Value             1.0000      0.9918
Prevalence                 0.2297      0.1802
Detection Rate             0.2297      0.1734
Detection Prevalence       0.2365      0.1757
Balanced Accuracy          0.9956      0.9799
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Precision and Recall}
\NormalTok{conf\_table\_log\_reg }\OtherTok{\textless{}{-}}\NormalTok{ conf\_matrix\_log\_reg}\SpecialCharTok{$}\NormalTok{table}
\NormalTok{precision\_log\_reg }\OtherTok{\textless{}{-}} \FunctionTok{diag}\NormalTok{(conf\_table\_log\_reg) }\SpecialCharTok{/} \FunctionTok{rowSums}\NormalTok{(conf\_table\_log\_reg)}
\NormalTok{recall\_log\_reg }\OtherTok{\textless{}{-}} \FunctionTok{diag}\NormalTok{(conf\_table\_log\_reg) }\SpecialCharTok{/} \FunctionTok{colSums}\NormalTok{(conf\_table\_log\_reg)}
\FunctionTok{print}\NormalTok{(}\StringTok{"Precision by class:"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Precision by class:"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(precision\_log\_reg)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     business entertainment      politics         sport          tech 
    0.9509804     0.9487179     0.9629630     0.9714286     0.9871795 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\StringTok{"Recall by class:"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Recall by class:"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(recall\_log\_reg)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     business entertainment      politics         sport          tech 
    0.9509804     0.9610390     0.9397590     1.0000000     0.9625000 
\end{verbatim}

The comparison between Multinomial Naïve Bayes and Multinomial Logistic
Regression reveals that Logistic Regression provides a marginally better
overall fit for this dataset. Logistic Regression achieves a higher
accuracy (96.4\% vs.~95.7\%) and kappa (0.9548 vs.~0.9463) compared to
Naïve Bayes, suggesting a stronger agreement with the true
classifications. Examining class-specific metrics, Logistic Regression
shows higher sensitivity across most categories, particularly for
``Business'' and ``Entertainment,'' which indicates a greater ability to
correctly identify positive instances in these classes. Naïve Bayes,
however, slightly outperforms Logistic Regression in the ``Politics''
category, where it has a sensitivity of 0.9880 compared to 0.9398 for
Logistic Regression. In terms of specificity, Logistic Regression
consistently surpasses Naïve Bayes, particularly in the ``Politics'' and
``Tech'' categories, which suggests that Logistic Regression is better
at correctly identifying negative instances for these classes.

Precision and recall scores reinforce these trends. Logistic Regression
demonstrates higher precision in ``Politics'' and ``Tech,'' while Naïve
Bayes provides slightly better precision for ``Entertainment'' and
``Sport.'' Both models achieve excellent recall, with Logistic
Regression slightly outperforming Naïve Bayes in the ``Entertainment''
and ``Tech'' categories. Both models, however, achieve perfect recall
for the ``Sport'' category, indicating that this class is
well-distinguished by both approaches. In summary, Multinomial Logistic
Regression provides a slight advantage in terms of accuracy,
specificity, and precision, making it a slightly more accurate model for
this dataset. Nevertheless, Multinomial Naïve Bayes remains a strong
contender and may be preferred when computational efficiency is a
priority, as it is less resource-intensive than Logistic Regression.




\end{document}
